"use strict";(self.webpackChunkexcel_dna=self.webpackChunkexcel_dna||[]).push([[2750],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=c(n),m=a,h=p["".concat(s,".").concat(m)]||p[m]||d[m]||r;return n?i.createElement(h,l(l({ref:t},u),{},{components:n})):i.createElement(h,l({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=p;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var c=2;c<r;c++)l[c]=n[c];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},1744:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var i=n(7462),a=(n(7294),n(3905));const r={sidebar_position:3,title:"Getting Started with Excel-DNA"},l=void 0,o={unversionedId:"archive/getting-started",id:"archive/getting-started",title:"Getting Started with Excel-DNA",description:"Do this first:",source:"@site/docs/archive/getting-started.md",sourceDirName:"archive",slug:"/archive/getting-started",permalink:"/docs/archive/getting-started",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Getting Started with Excel-DNA"},sidebar:"tutorialSidebar",previous:{title:"Archive",permalink:"/docs/category/archive"},next:{title:"Excel-DNA Performance",permalink:"/docs/archive/exceldna-performance"}},s={},c=[{value:"Do this first:",id:"do-this-first",level:2},{value:"1. Create a user-defined function in C#",id:"1-create-a-user-defined-function-in-c",level:2},{value:"2. Create a user-defined function in Visual Basic",id:"2-create-a-user-defined-function-in-visual-basic",level:2},{value:"3. Make the functions from a compiled library available",id:"3-make-the-functions-from-a-compiled-library-available",level:2}],u={toc:c};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"do-this-first"},"Do this first:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("strong",{parentName:"li"},".NET Framework 2.0 Runtime")," or a later version must be installed. The .NET Framework Version 2.0 Redistributable Package is available from Microsoft."),(0,a.kt)("li",{parentName:"ul"},"Get the most recent release of ",(0,a.kt)("strong",{parentName:"li"},"Excel-DNA"),": ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/Excel-DNA/ExcelDna/releases"},"https://github.com/Excel-DNA/ExcelDna/releases"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Macro security")," in Excel must not be ",(0,a.kt)("inlineCode",{parentName:"li"},"Very High")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"High")," (setting to ",(0,a.kt)("inlineCode",{parentName:"li"},"Medium")," is fine -- it will prompt whether to enable each macro library). To use the .NET macros you will have to ",(0,a.kt)("inlineCode",{parentName:"li"},"Enable")," at the prompt.")),(0,a.kt)("h2",{id:"1-create-a-user-defined-function-in-c"},"1. Create a user-defined function in C#"),(0,a.kt)("p",null,"Change the contents of ",(0,a.kt)("inlineCode",{parentName:"p"},"Test1.dna")," to:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'<DnaLibrary Language="CS">\n<![CDATA[\n  using ExcelDna.Integration;\n\n  public class MyFunctions\n  {\n      [ExcelFunction(Description="Joins a string to a number", Category="My functions")](ExcelFunction(Description=_Joins-a-string-to-a-number_,-Category=_My-functions_))\n      public static string JoinThem(string str, double val)\n      {\n          return str + val;\n      }\n  }\n]]>\n</DnaLibrary>\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Reload the ",(0,a.kt)("inlineCode",{parentName:"li"},".xll"),", either from File->Open or in Tools->Add-Ins."),(0,a.kt)("li",{parentName:"ul"},"Check with the formula ",(0,a.kt)("inlineCode",{parentName:"li"},'=JoinThem("abc", 123)')),(0,a.kt)("li",{parentName:"ul"},"If the first example worked, this one should too.")),(0,a.kt)("h2",{id:"2-create-a-user-defined-function-in-visual-basic"},"2. Create a user-defined function in Visual Basic"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Make a copy of ",(0,a.kt)("inlineCode",{parentName:"li"},"ExcelDna.xll")," in a convenient directory, calling the copy ",(0,a.kt)("inlineCode",{parentName:"li"},"Test1.xll"),"."),(0,a.kt)("li",{parentName:"ul"},"Create a new text file, called ",(0,a.kt)("inlineCode",{parentName:"li"},"Test1.dna")," (the same prefix as the ",(0,a.kt)("inlineCode",{parentName:"li"},".xll")," file), with contents:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<DnaLibrary>\n<![CDATA[\n  Public Module MyFunctions\n      Function AddThem(x, y)\n          AddThem = x + y\n      End Function\n  End Module\n]]>\n</DnaLibrary>\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Load Test1.xll in Excel (either ",(0,a.kt)("em",{parentName:"li"},"File->Open")," or ",(0,a.kt)("em",{parentName:"li"},"Tools->Add-Ins")," and ",(0,a.kt)("em",{parentName:"li"},"Browse..."),")."),(0,a.kt)("li",{parentName:"ul"},"You should be prompted whether to Enable Macros, click Enable."),(0,a.kt)("li",{parentName:"ul"},"Enter ",(0,a.kt)("inlineCode",{parentName:"li"},"=AddThem(4,2)")," into a cell - you should get ",(0,a.kt)("inlineCode",{parentName:"li"},"6"),". (Under some localized versions of Excel the parameters are separated by a ",(0,a.kt)("inlineCode",{parentName:"li"},";"),", so you'd say ",(0,a.kt)("inlineCode",{parentName:"li"},"=AddThem(4; 2)")," instead)."),(0,a.kt)("li",{parentName:"ul"},"There should also be an entry for ",(0,a.kt)("inlineCode",{parentName:"li"},"AddThem")," in the function wizard, under the category Test1.")),(0,a.kt)("p",null,"Troubleshooting"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"If you are not prompted to Enable Macros and nothing else happens, your security level is probably on High. Set it to Medium."),(0,a.kt)("li",{parentName:"ul"},"If you get a message indicating the .NET 2.0 runtime could not be loaded, you might not have the .NET Framework 2.0 installed. Install it."),(0,a.kt)("li",{parentName:"ul"},"If Excel crashes with an unhandled exception, an access violation or some other horrible error, either during loading or when running the function, please let me know. This shouldn't happen, and I would like to know if it does."),(0,a.kt)("li",{parentName:"ul"},"If a window appears with the title 'ExcelDna Error Display' then there were some errors trying to compile the code in the .dna file. Check that you have put the right code into the .dna file."),(0,a.kt)("li",{parentName:"ul"},"If Excel prompts for Enabling Macros, and then the function does not work and does not appear in the function wizard, you might not have the right filename for the .dna file. The prefix should be the same as the .xll file and it should be in the same directory."),(0,a.kt)("li",{parentName:"ul"},"Excel is only able to load add-ins, including .xll add-ins, if VBA is installed. (This is under the Office Shared Tools option when installing Office.) Check that VBA is installed by pressing Alt+F11 to open the VBA editor. If it does not open, add VBA to your Office installation."),(0,a.kt)("li",{parentName:"ul"},"Otherwise, if something goes wrong, let us know, or post on the discussion list.")),(0,a.kt)("h2",{id:"3-make-the-functions-from-a-compiled-library-available"},"3. Make the functions from a compiled library available"),(0,a.kt)("p",null,"Excel-DNA can also load any compiled .NET library. Public static functions with a compatible signature are exported to Excel."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Create a file called TestLib.cs containing the following code:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'using ExcelDna.Integration;\n\npublic class MyFunctions\n{\n    [ExcelFunction(Description="Multiplies two numbers", Category="Useful functions")](ExcelFunction(Description=_Multiplies-two-numbers_,-Category=_Useful-functions_))\n    public static double MultiplyThem(double x, double y)\n    {\n        return x * y;\n    }\n}\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"You need to reference the ",(0,a.kt)("inlineCode",{parentName:"li"},"ExcelDna.Integration.dll")," assembly (the ",(0,a.kt)("inlineCode",{parentName:"li"},"ExcelFunction")," attribute is defined there). Copy the file ",(0,a.kt)("inlineCode",{parentName:"li"},"ExcelDna.Integration.dll")," next to your source file, or reference it in your project. You need not redistribute this file - a copy is embedded as a resource in the redistributable ",(0,a.kt)("inlineCode",{parentName:"li"},".xll")),(0,a.kt)("li",{parentName:"ul"},"Compile ",(0,a.kt)("inlineCode",{parentName:"li"},"TestLib.cs")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"TestLib.dll"),": from the command-line: ",(0,a.kt)("inlineCode",{parentName:"li"},"C:\\Windows\\Microsoft.NET\\framework\\v2.0.50727\\csc.exe /target:library /reference:ExcelDna.Integration.dll TestLib.cs")),(0,a.kt)("li",{parentName:"ul"},"Modify ",(0,a.kt)("inlineCode",{parentName:"li"},"Test1.dna")," to contain:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<DnaLibrary>\n  <ExternalLibrary Path="TestLib.dll" />\n</DnaLibrary>\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Reload the .xll and check ",(0,a.kt)("inlineCode",{parentName:"li"},"=MultiplyThem(2,3)")," (or ",(0,a.kt)("inlineCode",{parentName:"li"},"=MultiplyThem(2; 3)")," on some versions)."),(0,a.kt)("li",{parentName:"ul"},"If you are compiling your assembly to target .NET 4, you need to tell Excel-DNA to load the right version of the CLR:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<DnaLibrary RuntimeVersion="v4.0" >\n  <ExternalLibrary Path="TestLib.dll" />\n</DnaLibrary>\n')))}d.isMDXComponent=!0}}]);