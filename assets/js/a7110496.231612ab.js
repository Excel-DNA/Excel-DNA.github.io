"use strict";(self.webpackChunkexcel_dna=self.webpackChunkexcel_dna||[]).push([[4893],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(n),f=o,m=p["".concat(c,".").concat(f)]||p[f]||d[f]||a;return n?r.createElement(m,i(i({ref:t},u),{},{components:n})):r.createElement(m,i({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=f;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},6587:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var r=n(7462),o=(n(7294),n(3905));const a={sidebar_position:0,title:"Introduction"},i=void 0,l={unversionedId:"guides-basic/excel-programming-interfaces/introduction",id:"guides-basic/excel-programming-interfaces/introduction",title:"Introduction",description:"Excel supports two completely different programming interfaces:",source:"@site/docs/guides-basic/excel-programming-interfaces/introduction.md",sourceDirName:"guides-basic/excel-programming-interfaces",slug:"/guides-basic/excel-programming-interfaces/introduction",permalink:"/docs/guides-basic/excel-programming-interfaces/introduction",draft:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0,title:"Introduction"},sidebar:"tutorialSidebar",previous:{title:"Excel Programming Interfaces",permalink:"/docs/category/excel-programming-interfaces"},next:{title:"Using the Excel COM Automation Interfaces",permalink:"/docs/guides-basic/excel-programming-interfaces/using-the-excel-com-automation-interfaces"}},c={},s=[],u={toc:s},p="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Excel supports two completely different programming interfaces:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The COM Automation interface that you know from VBA."),(0,o.kt)("li",{parentName:"ol"},"The native C API described in the Excel XLL SDK.")),(0,o.kt)("p",null,"Excel-DNA allows you to use either approach, and to mix them in your add-in to some extent."),(0,o.kt)("p",null,"Excel-DNA integrates into Excel using the C API. The following types are related to the C API:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"ExcelReference"),", which is a thin wrapper around a worksheet reference, and"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"XlCall.Excel")," and the ",(0,o.kt)("inlineCode",{parentName:"li"},"XlCall")," constants, which give you a .NET interface based on the xlcall.h file that defines the C API. So whenever you're dealing with either an ExcelReference or calling Excel via the XlCall.Excel interface, you are dealing with the C API. Once place the ExcelReference type pops up, is if you want to receive a sheet reference as one of the arguments to a function. Normally you'd just get the value of the cell(s) as the argument passed in, so if you actually want the reference, you should set your parameter to by of type 'object' and add a special attribute, ",(0,o.kt)("inlineCode",{parentName:"li"},"[ExcelArgument(AllowReference=true)](ExcelArgument(AllowReference=true))"),", to indicate that a reference should be passed. With this attribute, function calls that are passed a sheet reference will be called in your code with an object of type ExcelReference, allowing you to make further calls to the C API with this reference.")),(0,o.kt)("p",null,"On the other hand, the COM Automation interface can be used from your add-in as you would from VBA, taking the following into account:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"To get hold of the root Application object for the Excel instance that is hosting your add-in, you should call the helper property ",(0,o.kt)("inlineCode",{parentName:"li"},"ExcelDnaUtil.Application"),". Once you have the root Application object, you can get hold of everything else from there."),(0,o.kt)("li",{parentName:"ul"},"To use the COM Automation interface you either need to use the C# 4 ",(0,o.kt)("inlineCode",{parentName:"li"},"dynamic")," support, or reference an interop assembly that declares the COM types to .NET."),(0,o.kt)("li",{parentName:"ul"},"The support for calling COM was much improved in C# 4, whereas older versions you had to pass lots of ",(0,o.kt)("inlineCode",{parentName:"li"},"Missing")," arguments, and properties weren't easy to work with. To run .NET 4 in your Excel-DNA add-in, you need to add a flag in the .dna file that sets ",(0,o.kt)("inlineCode",{parentName:"li"},'RuntimeVersion="v4.0"'),"."),(0,o.kt)("li",{parentName:"ul"},"I normally recommend that one avoids using the COM Automation interface from within user-defined functions called from the worksheet. I have no good evidence, but suspect this sometimes causes issues. On the other hand, using the COM Automation interfaces elsewhere, like macros, ribbon handlers etc from your Excel-DNA seems to work perfectly.")))}d.isMDXComponent=!0}}]);