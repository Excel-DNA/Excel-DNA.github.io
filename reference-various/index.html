<!doctype html>
<html lang="en" dir="ltr" class="mdx-wrapper mdx-page plugin-pages plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Excel-DNA Reference: Wrapper SDK API, COM interface, Ribbon, Custom Task Panes, COM server support | Excel-DNA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://excel-dna.github.io/reference-various"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Excel-DNA Reference: Wrapper SDK API, COM interface, Ribbon, Custom Task Panes, COM server support | Excel-DNA"><meta data-rh="true" name="description" content="Wrapper for the Excel 97 / Excel 2007 SDK API"><meta data-rh="true" property="og:description" content="Wrapper for the Excel 97 / Excel 2007 SDK API"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://excel-dna.github.io/reference-various"><link data-rh="true" rel="alternate" href="https://excel-dna.github.io/reference-various" hreflang="en"><link data-rh="true" rel="alternate" href="https://excel-dna.github.io/reference-various" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Excel-DNA RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Excel-DNA Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X2RC1DGT94"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-X2RC1DGT94",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.cc0f1a7a.css">
<link rel="preload" href="/assets/js/runtime~main.5d4b2481.js" as="script">
<link rel="preload" href="/assets/js/main.610cb697.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Excel-DNA" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.svg" alt="Excel-DNA" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Excel-DNA</b></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://groups.google.com/g/exceldna" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item"><a href="https://github.com/Excel-DNA" target="_blank" rel="noopener noreferrer" class="header-github-link"></a></div><div class="navbar__item"><a href="https://groups.google.com/g/exceldna" target="_blank" rel="noopener noreferrer" class="header-googlegroup-link"></a></div><div class="navbar__item"><a href="https://www.youtube.com/user/govertvd" target="_blank" rel="noreferrer noopener" class="header-youtube-link"></a></div><div class="navbar__item"><a href="https://github.com/sponsors/Excel-DNA" target="_blank" rel="noopener noreferrer" class="header-sponsor-link"><svg class="sponsor-heart-icon" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" d="M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.75.75 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5zM8 14.25l-.345.666-.002-.001-.006-.003-.018-.01a7.643 7.643 0 01-.31-.17 22.075 22.075 0 01-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.08 22.08 0 01-3.744 2.584l-.018.01-.006.003h-.002L8 14.25zm0 0l.345.666a.752.752 0 01-.69 0L8 14.25z"></path></svg><span>&nbsp;&nbsp;Sponsor</span></a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><main class="container container--fluid margin-vert--lg"><div class="row mdxPageWrapper_j9I6"><div class="col col--8"><article><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wrapper-for-the-excel-97--excel-2007-sdk-api">Wrapper for the Excel 97 / Excel 2007 SDK API<a href="#wrapper-for-the-excel-97--excel-2007-sdk-api" class="hash-link" aria-label="Direct link to Wrapper for the Excel 97 / Excel 2007 SDK API" title="Direct link to Wrapper for the Excel 97 / Excel 2007 SDK API">​</a></h2><ul><li><code>XlCall</code> class: <code>XlCall.Excel</code> wraps <code>Excel4</code>/<code>Excel12</code> (but easy to call), also constants for all the API functions and commands.</li><li><code>XlCallException</code>: is thrown when the call to Excel fails.</li><li><code>XlCall.TryExcel</code>: does not throw exception on fail, but returns an <code>XlCallReturn</code> enum value.</li><li><code>ExcelDna.Integration.Integration</code>: contains the static method <code>RegisterMethods</code> which allow dynamic registration of methods.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="excel-com-interface-access">Excel COM interface access<a href="#excel-com-interface-access" class="hash-link" aria-label="Direct link to Excel COM interface access" title="Direct link to Excel COM interface access">​</a></h2><p><code>ExcelDna.Integration.ExcelDnaUtils.Application</code> returns the Excel Application COM object.</p><p>From VB this can be used late-bound quite easily.</p><p>From C# 4 late-binding through the <code>dynamic</code> type is recommended.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ribbon">Ribbon<a href="#ribbon" class="hash-link" aria-label="Direct link to Ribbon" title="Direct link to Ribbon">​</a></h2><p>To support the Excel 2007 / 2010 Ribbon interface, the addin (in a .dna file or <code>ExternalLibrary</code>) must contain at least one public class that is a direct subclass of <code>ExcelDna.Integration.CustomUI.ExcelRibbon</code>.</p><p>This class can also implement <code>ExcelDna.Integration.IExcelAddIn</code>, but need not.</p><p>For each such class, ExcelDna will dynamically register and load a COM add-in in the <code>AutoOpen</code> call (after calling all the <code>IExcelAddin.AutoOpen</code> methods). This will trigger the loading of the Ribbon UI, and Excel calls the <code>ExcelRibbon.GetCustomUI</code> method. This is a virtual method, with a default implementation that retrieves the ribbon xml from the .dna file. An add-in can override the default <code>GetCustomUI</code> method to explicitly return an xml appropriate string. All callback methods that the Ribbon calls must be implemented as public methods in the class derived from ExcelRibbon.</p><p>My goal for the multi-version <code>customUI</code> support is to allow you to create a single add-in that contains UI customization for each version. The idea is not to make a unified customization layer - the add-in could contain different code for different versions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="custom-task-panes">Custom Task Panes<a href="#custom-task-panes" class="hash-link" aria-label="Direct link to Custom Task Panes" title="Direct link to Custom Task Panes">​</a></h2><p>Support under <code>ExcelDna.Integration.CustomUI</code>.</p><p>The CustomTaskPane class defines the interfaces related to CTP&#x27;s.</p><p>A CTP must contain a <code>UserControl</code> (derived from <code>System.Windows.Forms.UserControl</code>).</p><p>Create a new <code>CustomTaskPane</code> containing an instance of <code>MyUserControl</code> by calling:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name keyword" style="color:#00009f">var</span><span class="token plain"> myCTP </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CustomTaskPaneFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">CreateCustomTaskPane</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token type-expression class-name">MyUserControl</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> myTitle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="com-server-support">COM Server support<a href="#com-server-support" class="hash-link" aria-label="Direct link to COM Server support" title="Direct link to COM Server support">​</a></h2><p>COM visible classes in ExternalLibrary tags marked <code>ComServer=&quot;true&quot;</code>, and COM visible classes that implement <code>IRtdServer</code> can be activated through the .xll directly. Even if the add-in is not loaded in Excel, such objects can be created in VBA.</p><p>These classes are (persistently) registered by calling <code>regsvr32 &lt;MyAddin&gt;.xll</code> or by <code>ComServer.DllRegisterServer()</code>, and unregistered by <code>regsvr32 /u &lt;MyAddin&gt;.xll</code> or by <code>ComServer.DllUnregisterServer()</code>.</p><p>Such classes can be accessed directly as RTD servers or from VBA using <code>CreateObject(&quot;MyServer.ItsProgId&quot;)</code>, and will be loaded in the add-in&#x27;s AppDomain. (The add-in need not be loaded for registered classes to be accessed through COM.)</p><p>A type library (.tlb) can be created for the assembly using tlbexp.exe, and will be registered if available. If the assembly is packed in the .xll, the type library will be packed too.</p></article></div><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#wrapper-for-the-excel-97--excel-2007-sdk-api" class="table-of-contents__link toc-highlight">Wrapper for the Excel 97 / Excel 2007 SDK API</a></li><li><a href="#excel-com-interface-access" class="table-of-contents__link toc-highlight">Excel COM interface access</a></li><li><a href="#ribbon" class="table-of-contents__link toc-highlight">Ribbon</a></li><li><a href="#custom-task-panes" class="table-of-contents__link toc-highlight">Custom Task Panes</a></li><li><a href="#com-server-support" class="table-of-contents__link toc-highlight">COM Server support</a></li></ul></div></div></div></main></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/guides---basic">Guides - Basic</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/guides---advanced">Guides - Advanced</a></li><li class="footer__item">
                  <a href="https://www.youtube.com/user/govertvd" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                  <img src="/img/youtube.png" alt="YouTube" width="20.42" height="14.4" style="margin-right:5px;">govertvd
                  </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Discussions</div><ul class="footer__items clean-list"><li class="footer__item">
                    <a href="https://groups.google.com/g/exceldna" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                    <img src="/img/google_groups.png" alt="Google Groups" width="16" height="16" style="margin-right:5px;">exceldna
                    </a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item">
                    <a href="https://github.com/Excel-DNA" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                    <img src="/img/github.png" alt="GitHub" width="16" height="16" style="margin-right:5px;">excel-dna
                    </a>
                </li><li class="footer__item">
                    <a href="mailto:govert@dnakode.com" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                    <img src="/img/email.png" alt="GitHub" width="16" height="11" style="margin-right:5px;">govert@dnakode.com
                    </a>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 DNA Kode, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5d4b2481.js"></script>
<script src="/assets/js/main.610cb697.js"></script>
</body>
</html>