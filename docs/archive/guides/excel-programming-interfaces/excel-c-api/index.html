<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-archive/guides/excel-programming-interfaces/excel-c-api">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Excel C API | Excel-DNA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://excel-dna.github.io/Website/docs/archive/guides/excel-programming-interfaces/excel-c-api"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Excel C API | Excel-DNA"><meta data-rh="true" name="description" content="The Excel C API was first introduced in Excel &#x27;95 and has continuously evolved with new versions of Excel. Excel-DNA uses the C API to integrate with Excel, though Excel-DNA add-in can also use the COM Automation interfaces where needed."><meta data-rh="true" property="og:description" content="The Excel C API was first introduced in Excel &#x27;95 and has continuously evolved with new versions of Excel. Excel-DNA uses the C API to integrate with Excel, though Excel-DNA add-in can also use the COM Automation interfaces where needed."><link data-rh="true" rel="icon" href="/Website/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://excel-dna.github.io/Website/docs/archive/guides/excel-programming-interfaces/excel-c-api"><link data-rh="true" rel="alternate" href="https://excel-dna.github.io/Website/docs/archive/guides/excel-programming-interfaces/excel-c-api" hreflang="en"><link data-rh="true" rel="alternate" href="https://excel-dna.github.io/Website/docs/archive/guides/excel-programming-interfaces/excel-c-api" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Website/blog/rss.xml" title="Excel-DNA RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Website/blog/atom.xml" title="Excel-DNA Atom Feed"><link rel="stylesheet" href="/Website/assets/css/styles.8e48ba13.css">
<link rel="preload" href="/Website/assets/js/runtime~main.d30142d9.js" as="script">
<link rel="preload" href="/Website/assets/js/main.33bbeb13.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Website/"><div class="navbar__logo"><img src="/Website/img/logo.svg" alt="Excel-DNA" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Website/img/logo_dark.svg" alt="Excel-DNA" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Excel-DNA</b></a><a class="navbar__item navbar__link" href="/Website/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/Website/blog">Blog</a><a href="https://groups.google.com/g/exceldna" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item"><a href="https://github.com/Excel-DNA" target="_blank" rel="noopener noreferrer" class="header-github-link"></a></div><div class="navbar__item"><a href="https://groups.google.com/g/exceldna" target="_blank" rel="noopener noreferrer" class="header-googlegroup-link"></a></div><div class="navbar__item"><a href="https://www.youtube.com/user/govertvd" target="_blank" rel="noreferrer noopener" class="header-youtube-link"></a></div><div class="navbar__item"><a href="https://github.com/sponsors/Excel-DNA" target="_blank" rel="noopener noreferrer" class="header-sponsor-link"><svg class="sponsor-heart-icon" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" d="M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.75.75 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5zM8 14.25l-.345.666-.002-.001-.006-.003-.018-.01a7.643 7.643 0 01-.31-.17 22.075 22.075 0 01-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.08 22.08 0 01-3.744 2.584l-.018.01-.006.003h-.002L8 14.25zm0 0l.345.666a.752.752 0 01-.69 0L8 14.25z"></path></svg><span>&nbsp;&nbsp;Sponsor</span></a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Website/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Website/docs/category/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Website/docs/category/guides---basic">Guides - Basic</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides - Basic&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Website/docs/category/guides---advanced">Guides - Advanced</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides - Advanced&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/Website/docs/category/archive">Archive</a><button aria-label="Toggle the collapsible sidebar category &#x27;Archive&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/Website/docs/category/guides">Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/Website/docs/category/excel-programming-interfaces">Excel Programming Interfaces</a><button aria-label="Toggle the collapsible sidebar category &#x27;Excel Programming Interfaces&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/excel-programming-interfaces/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/excel-programming-interfaces/using-the-excel-com-automation-interfaces">Using the Excel COM Automation Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Website/docs/archive/guides/excel-programming-interfaces/excel-c-api">Excel C API</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/accepting-range-parameters-in-udfs">Accepting Range Parameters in UDFs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/adding-keyboard-shortcut">Adding a Keyboard Shortcut</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/async-macro-example-formatting-the-calling-cell-from-a-udf">Async Macro Example</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/asynchronous-functions-with-tasks">Asynchronous Functions with Tasks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/building-excedna-from-source">Building Excel-DNA From Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/checking-and-downloading-updates-in-dotnet">Checking and Downloading Updates in .NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/com-server-support">COM Server Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/configuring-nlog-logging">Configuring NLog Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/creating-a-help-file">Creating a Help File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/creating-a-threaded-modal-dialog">Creating a Threaded Modal Dialog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/customizing-ribbons">Customizing Ribbons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/debugging-addins-and-exceldna">Debugging Addins and Excel-DNA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/detecting-excel-shutdown-and-autoclose">Detecting Excel Shutdown and AutoClose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/dynamic-delegate-registration">Dynamic Delegate Registration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/enumerating-excel-com-automation-collections">Enumerating Excel COM Automation Collections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/exceldna-packing-tool">Excel-DNA Packing Tool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/fsharp-standalone-assemblies">FSharp Standalone Assemblies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/fsharp-type-inference">FSharp Type Inference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/installing-your-add-in">Installing Your Add-in</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/integrating-with-vba">Integrating with VBA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/optional-parameters-and-default-values">Optional Parameters and Default Values</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/performing-asynchronous-work">Performing Asynchronous Work</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/reactive-extensions-for-excel-vbnet">Reactive Extensions for Excel - VB.NET</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/reactive-extensions-for-excel">Reactive Extensions for Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/user-settings-and-the-xllconfig-file">User Settings and the .xll.config File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/guides/utilising-customXMLparts-in-excel-workbooks">Utilising CustomXMLParts in Excel Workbooks</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/getting-started">Getting Started with Excel-DNA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/exceldna-performance">Excel-DNA Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Website/docs/archive/intoduction-excel-dna.github.io">Introduction - excel-dna.github.io</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/Website/docs/category/wiki">Wiki</a><button aria-label="Toggle the collapsible sidebar category &#x27;Wiki&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/Website/docs/category/obsolete">Obsolete</a><button aria-label="Toggle the collapsible sidebar category &#x27;Obsolete&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Website/docs/category/archive"><span itemprop="name">Archive</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Website/docs/category/guides"><span itemprop="name">Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Website/docs/category/excel-programming-interfaces"><span itemprop="name">Excel Programming Interfaces</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Excel C API</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Excel C API</h1></header><p>The Excel C API was first introduced in Excel &#x27;95 and has continuously evolved with new versions of Excel. Excel-DNA uses the C API to integrate with Excel, though Excel-DNA add-in can also use the COM Automation interfaces where needed.</p><p>The Excel C API is documented in the Excel XLL Software Development Kit, available from Microsoft here: <a href="http://msdn.microsoft.com/en-us/library/office/bb687883.aspx" target="_blank" rel="noopener noreferrer">http://msdn.microsoft.com/en-us/library/office/bb687883.aspx</a>. The most coherent reference to using the C API is the book by Stephen Dalton - Financial Applications using Excel Add-in Development in C / C++.</p><p>Direct access to the C API is provided by Excel-DNA via two classes:</p><ul><li><code>ExcelDna.Integration.ExcelReference</code></li><li><code>ExcelDna.Integration.XlCall</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="excelreference">ExcelReference<a class="hash-link" href="#excelreference" title="Direct link to heading">​</a></h2><p>The <code>ExcelReference</code> class is a thin wrapper around the C API sheet reference information, and refers to a region (or multiple regions) on a specific sheet. ExcelReference has helper methods to get and set the values in the region, but for additional information, specific C API calls must be made.</p><p>Using C API calls it is possible to get the address of an ExcelReference - calling <code>XlCall.Excel(XlCall.xlfReftext, myReference, true)</code> - and from there a COM <code>Range</code> object may be contructed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xlcall">XlCall<a class="hash-link" href="#xlcall" title="Direct link to heading">​</a></h2><p>The header file in the Excel SDK that defines the C API is called XLCALL.H, so I&#x27;ve called the matching Excel-DNA class <code>XlCall</code>. It contains these functions:</p><ul><li><code>XlCall.Excel</code> - Calls the <code>Excel4</code> / <code>Excel12</code> functions of the C API.</li><li><code>XlCall.TryExcel</code> - Same as <code>XlCall.Excel</code>, but returns an exact error result instead of throwing.</li><li><code>XlCall.RTD</code> - Wrapper around <code>XlCall.Excel(XlCall.xlfRtd, ...)</code> for the registration-free RTD support.</li></ul><p>The first parameter to the <code>XlCall.Excel</code> / <code>XlCall.TryExcel</code> methods is a function code that identifies the function or command. These function codes are all available as constants on the <code>XlCall</code> class. The other parameters are marshaled by Excel-DNA from the .NET types to the corresponding C API types. (The parameter count passed in to the Excel function from C is not required in the Excel-DNA call.) Sheet references are passed to the C API as ExcelReference objects. Missing values (that are not at the end of the call) should be passed as ExcelMissing.Value.</p><p>Excel-DNA takes care of all type conversion and memory management for the C API calls.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xlcall-functions">XlCall functions<a class="hash-link" href="#xlcall-functions" title="Direct link to heading">​</a></h2><p>There is no single source of documentation for all the XlCall functions. To piece together the available information, it helps to think of the functions in three classes:</p><ul><li>Auxiliary C API functions</li><li>Worksheet functions</li><li>Macro functions and commands</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="auxiliary-c-api-functions">Auxiliary C API functions<a class="hash-link" href="#auxiliary-c-api-functions" title="Direct link to heading">​</a></h3><p>These are functions like <code>xlfRegister</code> and <code>xlSheetId</code> that can only be called from add-ins. These form part of the main Excel SDK and are documented in the Excel SDK documentation here: <a href="http://msdn.microsoft.com/en-us/library/office/bb687870.aspx" target="_blank" rel="noopener noreferrer">http://msdn.microsoft.com/en-us/library/office/bb687870.aspx</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="worksheet-function">Worksheet function<a class="hash-link" href="#worksheet-function" title="Direct link to heading">​</a></h3><p>Most of the <code>XlCall.xlf...</code> function codes refer to regular Excel worksheet functions, like <code>xlfSum</code> and is documented in the regular Excel help.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="macro-functions-and-commands">Macro functions and commands<a class="hash-link" href="#macro-functions-and-commands" title="Direct link to heading">​</a></h3><p>Some information functions like <code>xlfGet...</code> and all the <code>xlc...</code> function codes refer to Excel 4.0 macro commands and macro sheet functions. These have no updated documentation, but are described in the Excel 4.0 macro help file. This file is officially available from Microsoft as a .hlp file here: <a href="http://support.microsoft.com/kb/128185" target="_blank" rel="noopener noreferrer">http://support.microsoft.com/kb/128185</a> but is not easy to open in Windows 7/8.</p><p>I also found a copy of this help file converted to a <code>.chm</code> file, kindly made available by Theo Heselmans here: <a href="http://www.xceed.be/Blog.nsf/dx/excel-macro-function-help-file-for-windows-7" target="_blank" rel="noopener noreferrer">http://www.xceed.be/Blog.nsf/dx/excel-macro-function-help-file-for-windows-7</a>.</p><p>I&#x27;ve also made a searchable <code>.pdf</code> version of the <a target="_blank" href="/Website/assets/files/excel-c-api-excel-4-macro-reference-7df97f7e896ff61d528847f9124b1927.pdf">Excel 4 Macro Reference</a>.</p><p>The help file documents the function in the macro form, but the names and parameters match the usage via the C API. For example, the macro function <code>GET.CELL(type_num, reference)</code> is called via the C API as <code>XlCall.Excel(XlCall.xlfGetCell, 7, myExcelReference)</code> - where the help file shows that 7 retrieves the number format of a cell. A comprehensive sample of the various <code>GET.XXX</code> information functions is available in the Excel-DNA distribution under Distribution\Samples\GetInfoAddIn.dna and the sheet GetInfoAddIn.xls.</p><p>Many of the C API functions have been discussed on the Excel-DNA Google group or elsewhere online, so searching at <a href="http://groups.google.com/group/exceldna" target="_blank" rel="noopener noreferrer">http://groups.google.com/group/exceldna</a> is a good start.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xlcall-tricks">XlCall tricks<a class="hash-link" href="#xlcall-tricks" title="Direct link to heading">​</a></h3><p>For add-ins made with VB.NET, the <code>XlCall</code> static class can be imported into a file with a call to <code>Imports ExcelDna.Integration.XlCall</code>. Then the functions can be called without the XlCall prefix: <code>myResult = Excel(xlfGetCell, 7, myReference)</code></p><p>Similarly for C#, a helper class that wraps some C API calls can derive from XlCall, as: <code>static class MyHelpers : XlCall</code> and functions inside the class can then call the Excel / TryExcel methods and all the XlCall constants without the XlCall prefix.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Website/docs/archive/guides/excel-programming-interfaces/using-the-excel-com-automation-interfaces"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Using the Excel COM Automation Interfaces</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Website/docs/archive/guides/accepting-range-parameters-in-udfs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Accepting Range Parameters in UDFs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#excelreference" class="table-of-contents__link toc-highlight">ExcelReference</a></li><li><a href="#xlcall" class="table-of-contents__link toc-highlight">XlCall</a></li><li><a href="#xlcall-functions" class="table-of-contents__link toc-highlight">XlCall functions</a><ul><li><a href="#auxiliary-c-api-functions" class="table-of-contents__link toc-highlight">Auxiliary C API functions</a></li><li><a href="#worksheet-function" class="table-of-contents__link toc-highlight">Worksheet function</a></li><li><a href="#macro-functions-and-commands" class="table-of-contents__link toc-highlight">Macro functions and commands</a></li><li><a href="#xlcall-tricks" class="table-of-contents__link toc-highlight">XlCall tricks</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Website/getting-started/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/Website/guides-basic/tempbasicguide">Guides - Basic</a></li><li class="footer__item"><a class="footer__link-item" href="/Website/guides-advanced/tempadvancedguide">Guides - Advanced</a></li><li class="footer__item">
                  <a href="https://www.youtube.com/user/govertvd" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                  <img src="/Website/img/youtube.png" alt="YouTube" width="20.42" height="14.4" style="margin-right:5px;">govertvd
                  </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Discussions</div><ul class="footer__items clean-list"><li class="footer__item">
                    <a href="https://groups.google.com/g/exceldna" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                    <img src="/TestDocs/img/google_groups.png" alt="Google Groups" width="16" height="16" style="margin-right:5px;">exceldna
                    </a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Website/blog">Blog</a></li><li class="footer__item">
                    <a href="https://github.com/Excel-DNA" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                    <img src="/Website/img/github.png" alt="GitHub" width="16" height="16" style="margin-right:5px;">excel-dna
                    </a>
                </li><li class="footer__item">
                    <a href="mailto:govert@dnakode.com" target="_blank" rel="noreferrer noopener" class="footer__link-item"> 
                    <img src="/Website/img/email.png" alt="GitHub" width="16" height="11" style="margin-right:5px;">govert@dnakode.com
                    </a>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 DNA Kode, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/Website/assets/js/runtime~main.d30142d9.js"></script>
<script src="/Website/assets/js/main.33bbeb13.js"></script>
</body>
</html>